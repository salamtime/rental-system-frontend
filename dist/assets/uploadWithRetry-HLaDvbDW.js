const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DVHQ_tVI.js","assets/index-DxxGcIEt.css"])))=>i.map(i=>d[i]);
import{_ as g}from"./index-DVHQ_tVI.js";async function p(d,l){try{const{supabase:i}=await g(async()=>{const{supabase:t}=await import("./index-DVHQ_tVI.js").then(o=>o.s);return{supabase:t}},__vite__mapDeps([0,1])),e=document.createElement("video"),r=document.createElement("canvas"),u=r.getContext("2d");if(!u)throw new Error("Canvas context not available");return new Promise((t,o)=>{const n=setTimeout(()=>{o(new Error("Thumbnail generation timeout"))},1e4);e.crossOrigin="anonymous",e.preload="metadata",e.muted=!0,e.playsInline=!0,e.onloadedmetadata=()=>{try{clearTimeout(n),r.width=e.videoWidth||640,r.height=e.videoHeight||360,e.currentTime=Math.min(1,e.duration*.1)}catch(a){clearTimeout(n),o(a)}},e.onseeked=async()=>{try{clearTimeout(n),u.drawImage(e,0,0,r.width,r.height),r.toBlob(async a=>{if(!a){t(null);return}try{const{data:c,error:s}=await i.storage.from("rental-videos").upload(l,a,{contentType:"image/jpeg",upsert:!1});if(s){console.warn("Thumbnail upload failed:",s),t(null);return}const{data:m}=i.storage.from("rental-videos").getPublicUrl(l);t(m.publicUrl)}catch(c){console.warn("Thumbnail upload error:",c),t(null)}},"image/jpeg",.8)}catch(a){clearTimeout(n),o(a)}},e.onerror=a=>{clearTimeout(n),o(new Error(`Video loading failed: ${a.message||"Unknown error"}`))},e.src=d})}catch(i){return console.warn("Thumbnail generation failed:",i),null}}export{p as generateThumbnailSafe};
